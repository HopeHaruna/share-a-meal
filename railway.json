{
	"$schema": "https://railway.app/railway.schema.json",
	"build": {
		"builder": "dockerfile"
	},
	"deploy": {
		"numReplicas": 1,
		"startCommand": "npm start",
		"restartPolicyType": "on_failure",
		"restartPolicyMaxRetries": 5,
		"healthchecks": {
			"enabled": true,
			"endpoint": "http://localhost:3000"
		}
	},
	"environments": {
		"production": {
			"name": "Production"
		},
		"staging": {
			"name": "Staging"
		}
	},
	"services": {
		"app": {
			"name": "ShareAMeal API",
			"buildCommand": "npm install",
			"startCommand": "npm run migrate && npm start"
		},
		"mysql": {
			"image": "mysql:8.0",
			"name": "ShareAMeal Database",
			"variables": {
				"MYSQL_ROOT_PASSWORD": "${{ secrets.MYSQL_ROOT_PASSWORD }}",
				"MYSQL_DATABASE": "sharemeal"
			}
		}
	}
}
